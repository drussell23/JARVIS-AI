<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JARVIS-like Automation Demo</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 100%);
            color: #e0e0e0;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        h1 {
            text-align: center;
            color: #00d4ff;
            font-size: 2.5em;
            margin-bottom: 30px;
            text-shadow: 0 0 20px rgba(0, 212, 255, 0.5);
        }
        
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(0, 212, 255, 0.3);
            border-radius: 15px;
            padding: 25px;
            backdrop-filter: blur(10px);
            transition: all 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 212, 255, 0.3);
            border-color: rgba(0, 212, 255, 0.5);
        }
        
        .card h2 {
            color: #00d4ff;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .icon {
            font-size: 1.5em;
        }
        
        input, select, textarea {
            width: 100%;
            padding: 12px;
            margin: 8px 0;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(0, 212, 255, 0.3);
            border-radius: 8px;
            color: #e0e0e0;
            font-size: 14px;
            transition: all 0.3s;
        }
        
        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #00d4ff;
            box-shadow: 0 0 10px rgba(0, 212, 255, 0.3);
        }
        
        button {
            background: linear-gradient(45deg, #00a8cc, #00d4ff);
            color: #000;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            font-size: 14px;
            transition: all 0.3s;
            margin: 5px;
        }
        
        button:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 20px rgba(0, 212, 255, 0.4);
        }
        
        button:active {
            transform: scale(0.98);
        }
        
        .result {
            background: rgba(0, 212, 255, 0.1);
            border: 1px solid rgba(0, 212, 255, 0.3);
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            max-height: 300px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            white-space: pre-wrap;
        }
        
        .event-list {
            list-style: none;
            padding: 0;
        }
        
        .event-item {
            background: rgba(255, 255, 255, 0.05);
            padding: 10px;
            margin: 5px 0;
            border-radius: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .weather-display {
            display: flex;
            align-items: center;
            gap: 20px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            margin-top: 15px;
        }
        
        .weather-icon {
            font-size: 3em;
        }
        
        .weather-info h3 {
            color: #00d4ff;
            margin-bottom: 5px;
        }
        
        .device-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        .device-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(0, 212, 255, 0.3);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .device-card:hover {
            background: rgba(0, 212, 255, 0.1);
        }
        
        .device-card.on {
            background: rgba(0, 212, 255, 0.2);
            border-color: #00d4ff;
        }
        
        .command-input {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(0, 212, 255, 0.5);
            border-radius: 30px;
            padding: 20px;
            margin: 30px 0;
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .command-input input {
            flex: 1;
            background: transparent;
            border: none;
            margin: 0;
            padding: 10px;
            font-size: 16px;
        }
        
        .command-input button {
            border-radius: 50%;
            width: 50px;
            height: 50px;
            padding: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }
        
        .status-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-left: 10px;
            background: #4caf50;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(0, 212, 255, 0.3);
            border-top-color: #00d4ff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ü§ñ JARVIS-like Automation System</h1>
        
        <!-- Natural Language Command Input -->
        <div class="command-input">
            <input type="text" id="commandInput" placeholder="Ask me anything... 'Schedule a meeting', 'What's the weather?', 'Turn on the lights'...">
            <button onclick="processCommand()">üé§</button>
        </div>
        
        <div class="grid">
            <!-- Calendar & Scheduling -->
            <div class="card">
                <h2><span class="icon">üìÖ</span> Calendar & Scheduling</h2>
                
                <input type="text" id="eventTitle" placeholder="Event title">
                <input type="datetime-local" id="eventTime">
                <input type="text" id="eventLocation" placeholder="Location (optional)">
                <button onclick="createEvent()">Create Event</button>
                
                <div style="margin-top: 20px;">
                    <h3>Natural Language Scheduling</h3>
                    <input type="text" id="naturalEvent" placeholder="e.g., 'Meeting with John tomorrow at 3pm'">
                    <button onclick="createNaturalEvent()">Schedule</button>
                </div>
                
                <div style="margin-top: 20px;">
                    <h3>Today's Events</h3>
                    <ul class="event-list" id="todayEvents"></ul>
                    <button onclick="loadTodayEvents()">Refresh</button>
                </div>
            </div>
            
            <!-- Weather Information -->
            <div class="card">
                <h2><span class="icon">üå§Ô∏è</span> Weather Information</h2>
                
                <input type="text" id="weatherLocation" placeholder="Enter location" value="London">
                <button onclick="getCurrentWeather()">Current Weather</button>
                <button onclick="getWeatherForecast()">5-Day Forecast</button>
                
                <div id="weatherDisplay"></div>
            </div>
            
            <!-- Information Services -->
            <div class="card">
                <h2><span class="icon">üì∞</span> Information Services</h2>
                
                <select id="infoType">
                    <option value="news">News</option>
                    <option value="stock">Stock</option>
                    <option value="crypto">Crypto</option>
                    <option value="wikipedia">Wikipedia</option>
                </select>
                
                <input type="text" id="infoQuery" placeholder="Query (e.g., 'technology', 'AAPL', 'BTC')">
                <button onclick="getInformation()">Get Info</button>
                
                <div class="result" id="infoResult"></div>
            </div>
            
            <!-- Home Automation -->
            <div class="card">
                <h2><span class="icon">üè†</span> Home Automation</h2>
                
                <button onclick="initializeDevices()">Initialize Demo Devices</button>
                
                <div class="device-grid" id="deviceGrid"></div>
                
                <div style="margin-top: 20px;">
                    <h3>Scenes</h3>
                    <button onclick="activateScene('movie')">üé¨ Movie Mode</button>
                    <button onclick="activateScene('sleep')">üò¥ Sleep Mode</button>
                    <button onclick="activateScene('work')">üíº Work Mode</button>
                </div>
            </div>
            
            <!-- Task Automation -->
            <div class="card">
                <h2><span class="icon">‚ö°</span> Task Automation</h2>
                
                <input type="text" id="taskName" placeholder="Task name">
                <select id="taskAction">
                    <option value="send_email">Send Email</option>
                    <option value="create_reminder">Create Reminder</option>
                    <option value="backup_files">Backup Files</option>
                    <option value="generate_report">Generate Report</option>
                </select>
                <button onclick="createTask()">Create Task</button>
                
                <div style="margin-top: 20px;">
                    <h3>Active Tasks</h3>
                    <div id="taskList"></div>
                    <button onclick="loadTasks()">Refresh Tasks</button>
                </div>
            </div>
            
            <!-- Command Results -->
            <div class="card" style="grid-column: 1 / -1;">
                <h2><span class="icon">üìä</span> Command Results</h2>
                <div class="result" id="commandResult">
                    Results will appear here...
                </div>
            </div>
        </div>
    </div>

    <script>
        const API_BASE = 'http://localhost:8000';
        
        // Natural Language Command Processing
        async function processCommand() {
            const command = document.getElementById('commandInput').value;
            if (!command) return;
            
            updateResult('commandResult', 'Processing: ' + command);
            
            try {
                const response = await fetch(`${API_BASE}/automation/command`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({command: command})
                });
                
                const data = await response.json();
                updateResult('commandResult', JSON.stringify(data, null, 2));
                
                // Clear input
                document.getElementById('commandInput').value = '';
                
                // Refresh relevant sections based on command type
                if (data.type === 'calendar') {
                    loadTodayEvents();
                } else if (data.type === 'weather') {
                    // Weather data already in result
                } else if (data.type === 'home_automation') {
                    loadDevices();
                }
                
            } catch (error) {
                updateResult('commandResult', 'Error: ' + error.message);
            }
        }
        
        // Calendar Functions
        async function createEvent() {
            const title = document.getElementById('eventTitle').value;
            const time = document.getElementById('eventTime').value;
            const location = document.getElementById('eventLocation').value;
            
            if (!title || !time) {
                alert('Please enter event title and time');
                return;
            }
            
            try {
                const response = await fetch(`${API_BASE}/automation/calendar/events`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        title: title,
                        start_time: new Date(time).toISOString(),
                        location: location
                    })
                });
                
                const data = await response.json();
                updateResult('commandResult', 'Event created: ' + JSON.stringify(data, null, 2));
                loadTodayEvents();
                
                // Clear inputs
                document.getElementById('eventTitle').value = '';
                document.getElementById('eventTime').value = '';
                document.getElementById('eventLocation').value = '';
                
            } catch (error) {
                updateResult('commandResult', 'Error: ' + error.message);
            }
        }
        
        async function createNaturalEvent() {
            const text = document.getElementById('naturalEvent').value;
            if (!text) return;
            
            try {
                const response = await fetch(`${API_BASE}/automation/calendar/events/natural`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({text: text})
                });
                
                const data = await response.json();
                updateResult('commandResult', 'Event scheduled: ' + JSON.stringify(data, null, 2));
                loadTodayEvents();
                
                document.getElementById('naturalEvent').value = '';
                
            } catch (error) {
                updateResult('commandResult', 'Error: ' + error.message);
            }
        }
        
        async function loadTodayEvents() {
            try {
                const response = await fetch(`${API_BASE}/automation/calendar/today`);
                const data = await response.json();
                
                const eventsList = document.getElementById('todayEvents');
                eventsList.innerHTML = '';
                
                if (data.events.length === 0) {
                    eventsList.innerHTML = '<li>No events today</li>';
                } else {
                    data.events.forEach(event => {
                        const li = document.createElement('li');
                        li.className = 'event-item';
                        li.innerHTML = `
                            <div>
                                <strong>${event.title}</strong><br>
                                <small>${event.start_time} ${event.location || ''}</small>
                            </div>
                            <button onclick="deleteEvent('${event.id}')">‚ùå</button>
                        `;
                        eventsList.appendChild(li);
                    });
                }
                
            } catch (error) {
                console.error('Error loading events:', error);
            }
        }
        
        async function deleteEvent(eventId) {
            try {
                await fetch(`${API_BASE}/automation/calendar/events/${eventId}`, {
                    method: 'DELETE'
                });
                loadTodayEvents();
            } catch (error) {
                console.error('Error deleting event:', error);
            }
        }
        
        // Weather Functions
        async function getCurrentWeather() {
            const location = document.getElementById('weatherLocation').value;
            if (!location) return;
            
            try {
                const response = await fetch(`${API_BASE}/automation/weather/current`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({location: location})
                });
                
                const data = await response.json();
                displayWeather(data.weather);
                
            } catch (error) {
                updateResult('commandResult', 'Error: ' + error.message);
            }
        }
        
        async function getWeatherForecast() {
            const location = document.getElementById('weatherLocation').value;
            if (!location) return;
            
            try {
                const response = await fetch(`${API_BASE}/automation/weather/forecast`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({location: location, forecast_days: 5})
                });
                
                const data = await response.json();
                displayForecast(data.forecast);
                
            } catch (error) {
                updateResult('commandResult', 'Error: ' + error.message);
            }
        }
        
        function displayWeather(weather) {
            const display = document.getElementById('weatherDisplay');
            display.innerHTML = `
                <div class="weather-display">
                    <div class="weather-icon">
                        ${getWeatherEmoji(weather.description)}
                    </div>
                    <div class="weather-info">
                        <h3>${weather.location}, ${weather.country}</h3>
                        <p style="font-size: 2em; margin: 10px 0;">${weather.temperature}¬∞C</p>
                        <p>${weather.description}</p>
                        <p>Feels like: ${weather.feels_like}¬∞C</p>
                        <p>Humidity: ${weather.humidity}% | Wind: ${weather.wind_speed} m/s</p>
                    </div>
                </div>
            `;
        }
        
        function displayForecast(forecast) {
            const display = document.getElementById('weatherDisplay');
            let html = '<h3>5-Day Forecast</h3><div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; margin-top: 15px;">';
            
            forecast.forEach(day => {
                html += `
                    <div style="text-align: center; padding: 10px; background: rgba(255,255,255,0.05); border-radius: 8px;">
                        <strong>${new Date(day.date).toLocaleDateString('en', {weekday: 'short'})}</strong><br>
                        ${getWeatherEmoji(day.description)}<br>
                        ${Math.round(day.temp_max)}¬∞ / ${Math.round(day.temp_min)}¬∞<br>
                        <small>${Math.round(day.rain_probability * 100)}% rain</small>
                    </div>
                `;
            });
            
            html += '</div>';
            display.innerHTML = html;
        }
        
        function getWeatherEmoji(description) {
            const desc = description.toLowerCase();
            if (desc.includes('rain')) return 'üåßÔ∏è';
            if (desc.includes('cloud')) return '‚òÅÔ∏è';
            if (desc.includes('sun') || desc.includes('clear')) return '‚òÄÔ∏è';
            if (desc.includes('snow')) return '‚ùÑÔ∏è';
            if (desc.includes('storm')) return '‚õàÔ∏è';
            return 'üå§Ô∏è';
        }
        
        // Information Functions
        async function getInformation() {
            const type = document.getElementById('infoType').value;
            const query = document.getElementById('infoQuery').value;
            
            if (!query) return;
            
            try {
                const response = await fetch(`${API_BASE}/automation/info/query`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({query_type: type, query: query})
                });
                
                const data = await response.json();
                updateResult('infoResult', JSON.stringify(data.data, null, 2));
                
            } catch (error) {
                updateResult('infoResult', 'Error: ' + error.message);
            }
        }
        
        // Home Automation Functions
        async function initializeDevices() {
            // This would normally be done on the backend
            const devices = [
                {id: 'light1', name: 'Living Room Light', type: 'light'},
                {id: 'light2', name: 'Bedroom Light', type: 'light'},
                {id: 'light3', name: 'Kitchen Light', type: 'light'},
                {id: 'thermostat1', name: 'Main Thermostat', type: 'thermostat'},
                {id: 'tv1', name: 'Living Room TV', type: 'tv'}
            ];
            
            updateResult('commandResult', 'Demo devices initialized');
            loadDevices();
        }
        
        async function loadDevices() {
            try {
                const response = await fetch(`${API_BASE}/automation/home/devices`);
                const data = await response.json();
                
                const grid = document.getElementById('deviceGrid');
                grid.innerHTML = '';
                
                data.devices.forEach(device => {
                    const card = document.createElement('div');
                    card.className = `device-card ${device.state.power === 'on' ? 'on' : ''}`;
                    card.innerHTML = `
                        <div style="font-size: 2em; margin-bottom: 10px;">
                            ${getDeviceEmoji(device.type)}
                        </div>
                        <strong>${device.name}</strong><br>
                        <small>${device.state.power || 'off'}</small>
                    `;
                    card.onclick = () => toggleDevice(device.id);
                    grid.appendChild(card);
                });
                
            } catch (error) {
                console.error('Error loading devices:', error);
            }
        }
        
        async function toggleDevice(deviceId) {
            try {
                const response = await fetch(`${API_BASE}/automation/home/devices/control`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        device_id: deviceId,
                        action: 'toggle'
                    })
                });
                
                loadDevices();
                
            } catch (error) {
                console.error('Error toggling device:', error);
            }
        }
        
        async function activateScene(sceneName) {
            try {
                const response = await fetch(`${API_BASE}/automation/home/scenes/${sceneName}`, {
                    method: 'POST'
                });
                
                const data = await response.json();
                updateResult('commandResult', `Scene '${sceneName}' activated`);
                loadDevices();
                
            } catch (error) {
                updateResult('commandResult', 'Error: ' + error.message);
            }
        }
        
        function getDeviceEmoji(type) {
            const emojis = {
                'light': 'üí°',
                'thermostat': 'üå°Ô∏è',
                'tv': 'üì∫',
                'speaker': 'üîä',
                'camera': 'üì∑'
            };
            return emojis[type] || 'üîå';
        }
        
        // Task Functions
        async function createTask() {
            const name = document.getElementById('taskName').value;
            const action = document.getElementById('taskAction').value;
            
            if (!name) return;
            
            try {
                const response = await fetch(`${API_BASE}/automation/tasks`, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        name: name,
                        action: action,
                        parameters: {}
                    })
                });
                
                const data = await response.json();
                updateResult('commandResult', 'Task created: ' + JSON.stringify(data, null, 2));
                loadTasks();
                
                document.getElementById('taskName').value = '';
                
            } catch (error) {
                updateResult('commandResult', 'Error: ' + error.message);
            }
        }
        
        async function loadTasks() {
            try {
                const response = await fetch(`${API_BASE}/automation/tasks`);
                const data = await response.json();
                
                const taskList = document.getElementById('taskList');
                taskList.innerHTML = '';
                
                data.tasks.forEach(task => {
                    const div = document.createElement('div');
                    div.className = 'event-item';
                    div.innerHTML = `
                        <div>
                            <strong>${task.name}</strong><br>
                            <small>Status: ${task.status} | Priority: ${task.priority}</small>
                        </div>
                        <button onclick="executeTask('${task.id}')">‚ñ∂Ô∏è</button>
                    `;
                    taskList.appendChild(div);
                });
                
            } catch (error) {
                console.error('Error loading tasks:', error);
            }
        }
        
        async function executeTask(taskId) {
            try {
                const response = await fetch(`${API_BASE}/automation/tasks/${taskId}/execute`, {
                    method: 'POST'
                });
                
                const data = await response.json();
                updateResult('commandResult', 'Task execution: ' + JSON.stringify(data, null, 2));
                loadTasks();
                
            } catch (error) {
                updateResult('commandResult', 'Error: ' + error.message);
            }
        }
        
        // Utility Functions
        function updateResult(elementId, content) {
            document.getElementById(elementId).textContent = content;
        }
        
        // Handle Enter key in command input
        document.getElementById('commandInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                processCommand();
            }
        });
        
        // Initialize on load
        window.onload = () => {
            loadTodayEvents();
            loadTasks();
        };
    </script>
</body>
</html>